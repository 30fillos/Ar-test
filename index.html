<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MindAR Test με πίσω κάμερα</title>

    <!-- A-Frame + MindAR -->
    <script src="https://cdn.jsdelivr.net/npm/aframe/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar/dist/mindar-image.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-mindar/dist/aframe-mindar-image.prod.js"></script>

    <style>
      body { margin: 0; overflow: hidden; }
    </style>
  </head>
  <body>
    <a-scene
      mindar-image="imageTargetSrc: ./targets.mind;"
      embedded
      color-space="sRGB"
      id="my-scene">
      
      <a-assets>
        <img id="heart" src="heart.png" />
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-image src="#heart" position="0 0 0" scale="0.5 0.5 0.5"></a-image>
      </a-entity>
    </a-scene>

    <script>
    (async () => {
      try {
        // Ζητάμε ρητά την πίσω κάμερα
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: { exact: "environment" } }
        });

        // Παίρνουμε το video element που χρησιμοποιεί το MindAR
        const sceneEl = document.querySelector("#my-scene");
        sceneEl.addEventListener("arReady", () => {
          const mindarComp = sceneEl.components["mindar-image"];
          if (mindarComp && mindarComp.video) {
            mindarComp.video.srcObject = stream;
          }
        });
      } catch (err) {
        console.error("Camera access error:", err);
        alert("Δεν μπόρεσα να ανοίξω πίσω κάμερα: " + err.message);
      }
    })();
    </script>
  </body>
</html>